<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Derivada por Definición</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #eef2f3;
      padding: 20px;
      text-align: center;
    }

    input, button {
      padding: 10px;
      margin: 10px;
      font-size: 16px;
      width: 300px;
      max-width: 90%;
    }

    #resultado {
      background-color: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      text-align: left;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    p {
      line-height: 1.7;
    }
  </style>
</head>
<body>
  <h1>Derivada por definición</h1>
  <p>Escribe una función polinómica en términos de x (ejemplo: x**2 + 3*x + 2)</p>
  <input type="text" id="funcion" placeholder="Ejemplo: x**2 + 3*x + 2">
  <br>
  <button onclick="calcularDerivada()">Calcular derivada paso a paso</button>

  <div id="resultado"></div>

  <script>
    function evaluar(funcion, x) {
      try {
        return eval(funcion.replace(/x/g, `(${x})`));
      } catch {
        throw new Error("Error al evaluar la función. Asegúrate de escribirla correctamente.");
      }
    }

    function derivadaPorDefinicion(funcion, x) {
      const h = 0.00001;
      const fx = evaluar(funcion, x);
      const fxh = evaluar(funcion, x + h);
      const derivada = (fxh - fx) / h;

      const pasos = [];

      pasos.push("Paso 1: Se parte de la definición de la derivada.");
      pasos.push("f'(x) = lim h→0 [f(x + h) - f(x)] / h");
      pasos.push("Esta fórmula representa el valor de la pendiente de la recta tangente a la función en un punto x específico.");

      pasos.push("");
      pasos.push(`Paso 2: Se tiene la función f(x) = ${funcion}`);
      pasos.push(`Evaluaremos la derivada en el punto x = ${x}`);

      pasos.push("");
      pasos.push(`Paso 3: Sustituimos x en la función con (x + h).`);
      pasos.push(`Calculamos f(x + h) usando un valor muy pequeño de h cercano a 0.`);
      pasos.push(`f(${x} + h) = f(${(x + h).toFixed(5)}) = ${fxh.toFixed(5)}`);

      pasos.push("");
      pasos.push(`Paso 4: Calculamos f(x)`);
      pasos.push(`f(${x}) = ${fx.toFixed(5)}`);

      pasos.push("");
      pasos.push(`Paso 5: Aplicamos la fórmula de la derivada:`);
      pasos.push(`[f(${x} + h) - f(${x})] / h = [${fxh.toFixed(5)} - ${fx.toFixed(5)}] / ${h}`);

      pasos.push("");
      pasos.push(`Paso 6: Realizamos la resta en el numerador:`);
      pasos.push(`${(fxh - fx).toFixed(5)} / ${h}`);

      pasos.push("");
      pasos.push(`Paso 7: Finalmente, dividimos entre h para obtener la derivada aproximada:`);
      pasos.push(`Derivada ≈ ${(derivada).toFixed(5)}`);

      pasos.push("");
      pasos.push(`Resultado: La derivada aproximada de f(x) en x = ${x} es ${derivada.toFixed(5)}`);

      return pasos;
    }

    function calcularDerivada() {
      const funcion = document.getElementById("funcion").value;
      const resultado = document.getElementById("resultado");
      resultado.innerHTML = "";

      const x = 1; // Puedes cambiar este valor si deseas evaluar en otro punto

      try {
        const pasos = derivadaPorDefinicion(funcion, x);

        pasos.forEach(paso => {
          const parrafo = document.createElement("p");
          parrafo.textContent = paso;
          resultado.appendChild(parrafo);
        });
      } catch (error) {
        resultado.innerHTML = `<p style="color:red;">⚠️ ${error.message}</p>`;
      }
    }
  </script>
</body>
</html>

