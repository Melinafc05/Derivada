<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora de Derivadas por Definición</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f9f9f9;
        }
        input, button {
            font-size: 18px;
            padding: 8px;
            margin: 5px 0;
        }
        .result, .steps {
            background-color: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            margin-top: 20px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Calculadora de Derivadas por Definición</h1>
    <label for="funcion">Ingresa una función f(x):</label><br>
    <input type="text" id="funcion" placeholder="Ejemplo: x^2 + 3*x"><br>
    <button onclick="calcularDerivada()">Calcular derivada</button>

    <div class="result" id="resultado"></div>
    <div class="steps" id="pasos"></div>

    <script>
        function evaluarFuncion(funcion, x) {
            try {
                return eval(funcion.replace(/x/g, `(${x})`));
            } catch {
                return NaN;
            }
        }

        function calcularDerivada() {
            const funcionInput = document.getElementById('funcion').value;
            const h = 0.00001;
            const x = 1;
            const fx = evaluarFuncion(funcionInput, x);
            const fxh = evaluarFuncion(funcionInput, x + h);
            const derivada = (fxh - fx) / h;

            document.getElementById('resultado').innerText = `La derivada aproximada de f(x) en x = ${x} es: ${derivada.toFixed(5)}`;

            let pasosTexto = "Paso a paso de la derivada por definición:\n";
            pasosTexto += "1. Utilizamos la definición de derivada:\n";
            pasosTexto += "   f'(x) = lim (h→0) [f(x+h) - f(x)] / h\n\n";
            pasosTexto += "2. Sustituimos x por x+h en la función:\n";
            pasosTexto += `   f(x+h) = ${funcionInput.replace(/x/g, "(x+h)")}\n\n`;
            pasosTexto += "3. Calculamos f(x+h) - f(x):\n";
            pasosTexto += `   = ${funcionInput.replace(/x/g, "(x+h)")} - (${funcionInput})\n\n`;
            pasosTexto += "4. Dividimos por h:\n";
            pasosTexto += `   [${funcionInput.replace(/x/g, "(x+h)")} - (${funcionInput})] / h\n\n`;
            pasosTexto += "5. Calculamos el límite cuando h tiende a 0 para obtener la derivada.\n\n";
            pasosTexto += "Nota: Este cálculo es aproximado usando un valor muy pequeño de h.\n";

            document.getElementById('pasos').innerText = pasosTexto;
        }
    </script>
</body>
</html>
